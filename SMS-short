package com.example.model_sms;

import android.Manifest;
import android.content.pm.PackageManager;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.view.View;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.Toast;

import androidx.appcompat.app.AppCompatActivity;
import androidx.core.app.ActivityCompat;

public class MainActivity extends AppCompatActivity {

    //private static final int MY_PERMISSIONS_REQUEST_SEND_SMS=0;
    ImageButton sendBtn;
    EditText phoneNo;
    EditText msgContent;
    //String phNo;
    //String msg;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        sendBtn = (ImageButton) findViewById(R.id.sendButton);
        phoneNo =(EditText) findViewById(R.id.number_input);
        msgContent = (EditText) findViewById(R.id.content_input);

        sendBtn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                    if(ActivityCompat.checkSelfPermission(MainActivity.this, Manifest.permission.SEND_SMS)== PackageManager.PERMISSION_GRANTED)
                    {
                        try{
                            SmsManager smsManager = SmsManager.getDefault();
                            smsManager.sendTextMessage(phoneNo.getText().toString(),null,msgContent.getText().toString(),null,null);
                            Toast.makeText(MainActivity.this, "SMS SENT!!", Toast.LENGTH_SHORT).show();

                        }catch(Exception e){
                            Toast.makeText(MainActivity.this, "ERROR!", Toast.LENGTH_SHORT).show();
                        }
                    }
                    else
                    {
                        ActivityCompat.requestPermissions(MainActivity.this,new String[]{Manifest.permission.SEND_SMS},0);
                    }
                
            }
        });
    }


}
